<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Music Feedback Discord</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
  <link href="src/css/style.css" rel="stylesheet">
</head>

<body class="submission-container">

  <!-- nav bar -->
<div id="nav-placeholder"></div>

<!-- Submit a Song -->
<section>
  <div class="text-light p-5 text-center" id="submission-page-container">
    <h1>Submit A Song</h1>
    <p>Music Feedback SoundCloud Playlist Submissions are now OPEN! We are currently accepting new submissions to be shared on our SoundCloud page.
        If you have not already, join the server and fill out the form below with your Discord username and a public SoudCloud link to your song.
    </p>

    <form id="submission-form" action="src/php/submit_song.php" method="post" onsubmit="showMessageAndReload(); return false;">
        <div class="mb-3">
            <label for="discord_user" class="form-label">Discord Username:</label>
            <input type="text" class="form-control custom-input" id="discord_user" name="discord_user" required>
        </div>
        <div class="mb-3">
            <label for="song_link" class="form-label">SoundCloud Link:</label>
            <input type="text" class="form-control custom-input" id="song_link" name="song_link" required>
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>

    <!-- submission confirmation message -->
    <div id="submission-message" style="display: none;" class="mt-3 text-success">
      <p>Submission sent!</p>
    </div>

  </div>
</section>


<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<!-- Reload form section -->
<script>
// Function to handle form submission
$(document).ready(function() {
    $('#submission-form').submit(function(e) {
        e.preventDefault(); // Prevent the default form submission

        // Serialize form data
        var formData = $(this).serialize();

        // Send AJAX request
        $.ajax({
            type: 'POST',
            url: $(this).attr('action'), // URL to submit form data
            data: formData,
            success: function(response) {
                // Hide the form
                $('#submission-form').hide();

                // Check the response
                console.log(response);

                // On success, display submission confirmation
                $('#submission-message').show();

                // Optional: Reset form fields
                $('#submission-form')[0].reset();
            },
            error: function(xhr, status, error) {
                // Log the error for debugging
                console.error(xhr.responseText);
            }
        });
    });
});
</script>

</script> 


<!--- loads nav bar -->
<script>
// Load the navigation bar using jQuery
  $(function() {
  $('#nav-placeholder').load('nav.html');
  });
</script>




</body>
</html>
