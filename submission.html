<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Music Feedback Discord</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
  <link href="src/css/style.css" rel="stylesheet">
</head>

<body class="submission-container">

<!-- nav bar -->
<nav class="navbar navbar-expand-lg navbar-dark" id="navbar-container">
  <div class="container">
    <img src="src/Images/MusicFeedbackBanner.jpg" alt="Music Feedback logo">
    <!-- drop down menu on collapse -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navmenu">
      <span class="navbar-toggler-icon"></span>
    </button>
    <!-- nav bar items -->
    <div class="collapse navbar-collapse" id="navmenu">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" target="_blank" href="https://discord.com/invite/USgMVqc9yh">Discord</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="submission.html">Submit A Song</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Submit a Song -->
<section>
  <div class="text-light p-5 text-center" id="submission-page-container">
    <h1>Submit A Song</h1>
    <p>Music Feedback SoundCloud Playlist Submissions are now OPEN! We are currently accepting new submissions to be shared on our SoundCloud page.
        If you have not already, join the server and fill out the form below with your Discord username and a public SoudCloud link to your song.
    </p>

    <form id="submission-form" action="src/php/submit_song.php" method="post">
        <div class="mb-3">
            <label for="discord_user" class="form-label">Discord Username:</label>
            <input type="text" class="form-control custom-input" id="discord_user" name="discord_user" required>
        </div>
        <div class="mb-3">
            <label for="song_link" class="form-label">SoundCloud Link:</label>
            <input type="text" class="form-control custom-input" id="song_link" name="song_link" required>
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>

    <!-- submission confirmation message -->
    <div id="submission-message" style="display: none;" class="mt-3 text-success">
      <p><strong>Submission sent!</strong></p>
      <a class="btn btn-primary rounded-pill lead my-4 return-home" id="return-home" href="index.html">Return Home</a>
    </div>

    <!-- submission rejection-->
    <div id="rejection-message" style="display: none;" class="mt-3 text-success">
      <p><strong>Submission not sent!</strong> Please check that you spelled your username correctly and are a member of the Music Feedback Discord.</p>
      <div class="button-group">
        <a class="btn btn-primary rounded-pill lead my-4" href="submission.html">Submit Again</a>
        <a class="btn btn-primary rounded-pill lead my-4 return-home" id="return-home" href="index.html">Return Home</a>
      </div>
    </div>

  </div>
</section>


<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<!-- Reload form section -->
<script>
// Function to handle form submission
$(document).ready(function() {
    $('#submission-form').submit(function(e) {
        e.preventDefault(); // Prevent the default form submission

        // Serialize form data
        var formData = $(this).serialize();

        // Send AJAX request
        $.ajax({
            type: 'POST',
            url: $(this).attr('action'), // URL to submit form data
            data: formData,
            success: function(response) {
                // Hide the form
                $('#submission-form').hide();

                // Check the response
                console.log(response);

                if (response.trim() === 'success') {
                    // On success, display submission confirmation
                    $('#submission-message').show();
                    $('#rejection-message').hide(); // rejection message is hidden
                    //  reset form fields
                    $('#submission-form')[0].reset();
                } else {
                    // show rejection message and hide success message
                    $('#submission-message').hide();
                    $('#rejection-message').show();
                }
            },
            error: function(xhr, status, error) {
                // Log the error for debugging
                console.error(xhr.responseText);

                // Show rejection message on error and hide success message
                $('#submission-message').hide();
                $('#rejection-message').show();
            }
        });
    });
});
</script>

</script> 


<!--- loads nav bar -->
<script>
// Load the navigation bar using jQuery
  $(function() {
  $('#nav-placeholder').load('nav.html');
  });
</script>



</body>
</html>
